"use strict";(self.webpackChunkjmoney=self.webpackChunkjmoney||[]).push([[63],{4624(e,t,a){a.d(t,{A:()=>s});a(5043);var n=a(579);const s=e=>{let{message:t="No data",height:a=150,width:s=150,children:i}=e;return(0,n.jsxs)("div",{className:"no-data-card",children:[(0,n.jsx)("div",{className:"no-data-image",children:(0,n.jsxs)("svg",{width:s,height:a,viewBox:"0 0 184 152",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("title",{children:"No data"}),(0,n.jsxs)("g",{fill:"none",fillRule:"evenodd",children:[(0,n.jsxs)("g",{transform:"translate(24 31.67)",children:[(0,n.jsx)("ellipse",{fillOpacity:".8",fill:"#F5F5F7",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),(0,n.jsx)("path",{d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z",fill:"#AEB8C2"}),(0,n.jsx)("path",{d:"M101.537 86.214L80.63 61.102c-1.001-1.207-2.507-1.867-4.048-1.867H31.724c-1.54 0-3.047.66-4.048 1.867L6.769 86.214v13.792h94.768V86.214z",fill:"url(#linearGradient-1)",transform:"translate(13.56)"}),(0,n.jsx)("path",{d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z",fill:"#F5F5F7"}),(0,n.jsx)("path",{d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z",fill:"#DCE0E6"})]}),(0,n.jsx)("path",{d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z",fill:"#DCE0E6"}),(0,n.jsxs)("g",{transform:"translate(149.65 15.383)",fill:"#FFF",children:[(0,n.jsx)("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),(0,n.jsx)("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"})]})]})]})}),(0,n.jsxs)("div",{className:"no-data-description",children:[t,i]})]})}},6908(e,t,a){a.d(t,{A:()=>s});a(5043);var n=a(579);const s=e=>{let{title:t,subtitle:a,children:s,customStyles:i={}}=e;return(0,n.jsxs)("div",{className:"overview-card",style:i,children:[(0,n.jsxs)("div",{className:"overview-card-header",children:[(0,n.jsx)("h2",{className:"overview-card-title",children:t}),(0,n.jsx)("p",{className:"overview-card-subtitle",children:a})]}),(0,n.jsx)("div",{className:"overview-card-body",children:s})]})}},1794(e,t,a){a.d(t,{A:()=>r});var n=a(6756),s=(a(5043),a(184)),i=a(579);const r=e=>{let{transaction:t,onCardClick:a=()=>{}}=e;const{amount:r,category_name:l,category_icon:c,description:o,payee_name:d,payee_logo:u,type:m,transaction_timestamp:h,percentage:g=null,product_link:x=null}=t;return(0,i.jsxs)("div",{className:"transaction-card",onClick:a,children:[(0,i.jsxs)("div",{className:"transaction-left",children:[(0,i.jsx)("div",{className:"transaction-icon ".concat("Expense"===m?"expense":"income"),children:(0,n.sH)(c)}),(0,i.jsxs)("div",{className:"transaction-details",children:[(0,i.jsx)("div",{className:"category-name",children:l}),o&&(0,i.jsx)("div",{className:"description",children:o}),h&&(0,i.jsx)("div",{className:"timestamp",children:(0,n.Ey)(h)}),(0,i.jsx)("div",{className:"payee-info",children:(u||x)&&(0,i.jsxs)(i.Fragment,{children:[u&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("img",{src:u,alt:d,className:"transaction-payee-logo"}),(0,i.jsx)("span",{className:"transaction-payee-name",children:d})]}),x&&(0,i.jsx)("a",{href:x,target:"_blank",rel:"noopener noreferrer",style:{color:"#007bff",cursor:"pointer"},onClick:e=>e.stopPropagation(),children:(0,i.jsx)(s.EQc,{size:14,color:"#007bff",title:"Product Link"})})]})})]})]}),(0,i.jsxs)("div",{className:"transaction-amount-section",children:[(0,i.jsx)("div",{className:"transaction-amount ".concat("Expense"===m?"expense":"income"),children:(0,n.mC)(Number(r))}),null!==g&&(0,i.jsxs)("div",{className:"transaction-percentage",children:[g,"%"]})]})]})}},9984(e,t,a){a.d(t,{A:()=>s});a(5043);var n=a(579);const s=e=>{let{progress:t=0,text:a="",subtext:s="",pathColor:i="#3b82f6",textColor:r="#000",fontSize:l="1rem",size:c=100,strokeWidth:o=10}=e;const d=(c-o)/2,u=2*Math.PI*d,m=u*(1-t/100);return(0,n.jsxs)("svg",{width:c,height:c,viewBox:"0 0 ".concat(c," ").concat(c),children:[(0,n.jsx)("circle",{cx:c/2,cy:c/2,r:d,fill:"none",stroke:"#e5e7eb",strokeWidth:o}),(0,n.jsx)("circle",{cx:c/2,cy:c/2,r:d,fill:"none",stroke:i,strokeWidth:o,strokeDasharray:u,strokeDashoffset:m,strokeLinecap:"round",transform:"rotate(-90 ".concat(c/2," ").concat(c/2,")"),style:{transition:"stroke-dashoffset 0.5s ease"}}),(0,n.jsx)("text",{x:"50%",y:s?"40%":"50%",textAnchor:"middle",dominantBaseline:"central",fill:r,fontSize:l,fontWeight:"bold",children:a}),s&&(0,n.jsx)("text",{x:"50%",y:"60%",textAnchor:"middle",dominantBaseline:"central",fill:r,fontSize:l,fontWeight:"bold",children:s})]})}},1305(e,t,a){a.d(t,{A:()=>r});var n=a(5043),s=a(5843),i=a(579);const r=e=>{let{value:t=0,color:a="#3ecf8e",height:r="10px"}=e;const l=(0,n.useRef)(null),{ref:c,inView:o}=(0,s.Wx)();return(0,n.useEffect)((()=>{if(o&&l.current){const e="".concat(Math.min(t,100),"%");l.current.style.width=e,l.current.classList.add("animate")}}),[o,t]),(0,n.useEffect)((()=>{l.current&&!o&&(l.current.style.width="0%",l.current.classList.remove("animate"))}),[o]),(0,i.jsx)("div",{className:"progress-bar-container",ref:c,style:{height:r},children:(0,i.jsx)("div",{className:"progress-bar-fill",ref:l,style:{backgroundColor:a}})})}},6405(e,t,a){a.d(t,{A:()=>s});a(5043);var n=a(579);const s=e=>{let{text:t="Loading Transactions..."}=e;return(0,n.jsxs)("div",{className:"inline-loader",children:[(0,n.jsx)("div",{className:"spinner"}),(0,n.jsx)("span",{className:"loader-text",children:t})]})}},6380(e,t,a){a.d(t,{A:()=>i});var n=a(9379),s=(a(5043),a(579));const i=e=>{let{variant:t="text",width:a,height:i,className:r="",count:l=1,style:c={}}=e;const o=Array.from({length:l});return(0,s.jsx)(s.Fragment,{children:o.map(((e,l)=>{const o="skeleton skeleton-".concat(t," ").concat(r),d=(0,n.A)({width:a,height:i},c);return(0,s.jsx)("div",{className:o,style:d,"data-testid":"skeleton-loader"},l)}))})}},1486(e,t,a){a.d(t,{A:()=>i});var n=a(3261),s=a(579);const i=e=>{let{options:t,value:a,onChange:i,isDisabled:r=!1,isMulti:l=!1,placeholder:c="",isSearchable:o=!1}=e;return(0,s.jsx)(n.Ay,{className:"react-select-container",classNamePrefix:"react-select",options:t,value:a,onChange:i,isDisabled:r,isMulti:l,placeholder:c,isSearchable:o})}},4770(e,t,a){a.d(t,{A:()=>r});var n=a(6756),s=a(1486),i=(a(5043),a(579));const r=e=>{let{showYear:t=!0,showMonth:a=!0,yearValue:r,onYearChange:l,monthValue:c,onMonthChange:o,disabled:d}=e;return(0,i.jsxs)("div",{className:"filters-wrapper",children:[t&&(0,i.jsx)(s.A,{options:(0,n.gD)(),value:r,onChange:l,isDisabled:d}),a&&(0,i.jsx)(s.A,{options:(0,n.Ly)(r.value),value:c,onChange:o,isDisabled:d})]})}},2916(e,t,a){a.d(t,{A:()=>l});var n=a(6756),s=a(4624),i=(a(5043),a(1794)),r=a(579);const l=e=>{var t,a;let{name:l,amount:c,transactions:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"date-summary-bar",children:[(0,r.jsx)("div",{style:{display:"flex"},children:l?(0,r.jsx)("div",{className:"summary-date",children:l}):(0,r.jsx)(r.Fragment,{})}),c?(0,r.jsx)("div",{className:"summary-amount",children:(0,n.mC)(c)}):(0,r.jsx)(r.Fragment,{})]}),o&&(0,r.jsxs)("div",{className:"transaction-page-wrapper",children:[null===Object||void 0===Object||null===(t=Object.entries(o))||void 0===t?void 0:t.map((e=>{let[t,a]=e;return(0,r.jsxs)("div",{className:"transaction-group",children:[(0,r.jsx)("h2",{className:"transaction-date-header",children:(0,n.Qm)(t)}),(0,r.jsx)("div",{className:"transaction-card-list",children:null===a||void 0===a?void 0:a.map((e=>(0,r.jsx)(i.A,{transaction:e},e.id)))})]},t)})),0===(null===Object||void 0===Object||null===(a=Object.entries(o))||void 0===a?void 0:a.length)&&(0,r.jsx)(s.A,{message:"No transactions"})]})]})}},2771(e,t,a){a.d(t,{A:()=>s});var n=a(5043);const s=()=>{const[e,t]=(0,n.useState)(document.documentElement.getAttribute("data-theme")||"light");return(0,n.useEffect)((()=>{const e=new MutationObserver((()=>{const e=document.documentElement.getAttribute("data-theme");t(e||"light")}));return e.observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),()=>e.disconnect()}),[]),e}},1063(e,t,a){a.r(t),a.d(t,{default:()=>R});var n=a(9379),s=a(9570),i=a(4977),r=a(9992);const l=[{value:"name",label:"Sort by Name"},{value:"amount",label:"Sort by Budget Amount"},{value:"spent",label:"Sort by Spent"},{value:"percentage_spent",label:"Sort by % Spent"},{value:"percentage_remaining",label:"Sort by % Remaining"}];var c=a(4172),o=a(6756),d=a(5043),u=a(2024),m=a(184),h=a(8861),g=a(1486),x=a(579);const v=e=>{let{initialData:t,onSave:a,onCancel:s,saving:i,categoryOptions:r}=e;const[l,c]=(0,d.useState)({name:"",amount:"",interval:"Month",start_date:"",categories:[],logo:""});(0,d.useEffect)((()=>{if(t){let e;e=r.filter((e=>t.categories.includes(e.value))),c({name:t.name||"",amount:t.amount||"",interval:t.interval||"Month",start_date:t.start_date||"",categories:e||[],logo:t.logo||""})}else c({name:"",amount:"",interval:"Month",start_date:"",categories:[],logo:""})}),[t,r]);return(0,x.jsxs)("div",{className:"budget-dialog-content",children:[(0,x.jsx)("input",{type:"text",placeholder:"Name",value:l.name,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{name:e.target.value}))}),(0,x.jsx)("input",{type:"number",placeholder:"Amount",value:l.amount,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{amount:e.target.value}))}),(0,x.jsx)("select",{value:l.interval,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{interval:e.target.value})),children:(0,x.jsx)("option",{value:"Month",children:"Month"})}),(0,x.jsx)("input",{type:"date",value:l.start_date,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{start_date:e.target.value}))}),(0,x.jsx)("input",{type:"text",placeholder:"Logo URL",value:l.logo,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{logo:e.target.value}))}),(0,x.jsx)(g.A,{isMulti:!0,options:r,placeholder:"Select Categories",value:l.categories,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{categories:e})),isSearchable:!0}),(0,x.jsxs)("div",{className:"budget-dialog-actions",children:[(0,x.jsx)(h.A,{icon:(0,x.jsx)(m.dIn,{}),text:"Save",variant:"success",onClick:()=>{l.name&&l.amount&&l.start_date?a(l):alert("Please fill Name, Amount, and Start Date")},disabled:i}),(0,x.jsx)(h.A,{icon:(0,x.jsx)(m.yyx,{}),text:"Cancel",variant:"warning",onClick:s})]})]})};var j=a(6908),p=a(1305);const f=e=>{let{budget:t,selectedYear:a,selectedMonth:n,onViewTransations:s}=e;const{amount:i,percentage_remaining:r,spent:l}=t,c=new Date,o=c.getFullYear()===a.value&&c.getMonth()===n.value,d=new Date(a.value,n.value+1,0).getDate(),u=d-(o?c.getDate():d)+1,g=Math.max(i-l),v=o&&u>0?+(g/u).toFixed(2):0,f=r<0,y=f?(0,x.jsx)(m.BS8,{color:"red"}):(0,x.jsx)(m.A7C,{color:"green"}),b=f?"OverSpent: You overspent this period":o?"In Budget: You are on budget":"In Budget: Fantastic! You remained on budget",N=Math.max(i-l),w=r<0?101:r;return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(j.A,{customStyles:{cursor:"default"},children:[(0,x.jsxs)("div",{className:"budget-info-header",children:[y," ",(0,x.jsx)("span",{className:"budget-status-text",children:b})]}),(0,x.jsxs)("div",{className:"budget-info-grid",children:[o?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"info-block",children:[(0,x.jsx)("div",{className:"info-title",children:"You can spend"}),(0,x.jsxs)("div",{className:"info-amount",children:["\u20b9",v]}),(0,x.jsx)("div",{className:"info-subtitle",children:"per day"})]}),(0,x.jsxs)("div",{className:"info-block",children:[(0,x.jsx)("div",{className:"info-title",children:"Spent so far"}),(0,x.jsxs)("div",{className:"info-amount red-text",children:["\u20b9",l.toFixed(2)]}),(0,x.jsx)("div",{className:"info-subtitle",children:"TOTAL"})]})]}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"info-block",children:[(0,x.jsx)("div",{className:"info-title",children:"Saved"}),(0,x.jsxs)("div",{className:"info-amount ".concat(N>0?"green-text":"red-text"),children:["\u20b9",N.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"info-block",children:[(0,x.jsx)("div",{className:"info-title",children:"Spent"}),(0,x.jsxs)("div",{className:"info-amount red-text",children:["\u20b9",l.toFixed(2)]}),(0,x.jsx)("div",{className:"info-subtitle",children:"TOTAL"})]})]}),(0,x.jsxs)("div",{className:"info-block",children:[(0,x.jsx)("div",{className:"info-title",children:"Remaining"}),(0,x.jsxs)("div",{className:"info-amount",children:[r.toFixed(2),"%"]})]}),(0,x.jsxs)("div",{className:"info-block",children:[(0,x.jsx)("div",{className:"info-title",children:"Budgeted"}),(0,x.jsxs)("div",{className:"info-amount green-text",children:["\u20b9",i.toFixed(2)]})]})]}),o&&(0,x.jsxs)("div",{className:"remaining-days-text",style:{marginBottom:10},children:[u," Remaining day",1!==u?"s":""]}),(0,x.jsx)(p.A,{value:w,color:w<101?"#3ecf8e":"#ef4444"}),(0,x.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10,marginBottom:5},children:[(0,x.jsxs)("span",{className:"info-subtitle",children:["01 ",n.label," ",a.label]}),(0,x.jsxs)("span",{className:"info-subtitle",children:[d," ",n.label," ",a.label]})]})]}),(0,x.jsx)("div",{className:"info-block",children:(0,x.jsx)(h.A,{text:"View Transactions",fullWidth:!0,variant:"info",className:"text-center",onClick:s})})]})};var y=a(6720),b=a(9984),N=a(2771);const w=e=>{let{title:t,amount:a,interval:n,startDate:s,logo:i,onEdit:r,onDelete:l,spent:c=0,percentage_spent:d=10,percentage_remaining:u=90,onClick:m}=e;const g=(0,N.A)();return(0,x.jsxs)("div",{className:"budget-card",children:[(0,x.jsxs)("div",{className:"budget-card-header",children:[(0,x.jsxs)("div",{className:"budget-card-title",children:[t," "]}),(0,x.jsx)("div",{className:"budget-progress",children:(0,x.jsx)(b.A,{progress:u,text:"".concat(Math.round(u),"%"),pathColor:"#3ecf8e",textColor:"dark"===g?"#f1f1f1":"#374151",fontSize:"13px",size:40,strokeWidth:4})})]}),(0,x.jsx)("div",{className:"budget-card-body",onClick:m,children:(0,x.jsxs)("div",{className:"budget-amount-container",children:[(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"amount-label",children:"Budgeted"}),(0,x.jsx)("div",{className:"amount-value green-text",children:(0,o.mC)(a||0)})]}),(0,x.jsx)("div",{className:"divider"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"amount-label",children:"Spent"}),(0,x.jsx)("div",{className:"amount-value red-text",children:(0,o.mC)(c||0)})]}),(0,x.jsx)("div",{className:"divider"}),(0,x.jsxs)("div",{children:[(0,x.jsx)("div",{className:"amount-label",children:"Remaining"}),(0,x.jsx)("div",{className:"amount-value ",children:(0,o.mC)(a-c||0)})]})]})}),(0,x.jsxs)("div",{className:"budget-card-actions",children:[(0,x.jsx)(h.A,{icon:(0,x.jsx)(y.MdModeEditOutline,{}),variant:"primary",onClick:r}),(0,x.jsx)(h.A,{icon:(0,x.jsx)(y.MdDelete,{}),variant:"danger",onClick:l})]})]})};var A=a(423),C=a(4624),_=a(6380);const k=e=>{let{loading:t,sortedBudgets:a,refreshData:n,handleDialogOpen:s,handleDelete:i,onBudgetCardClick:r}=e;return(0,x.jsx)("div",{className:"budget-card-container",children:t?(0,x.jsx)(_.A,{count:8,keyName:"budget-card",height:80}):(null===a||void 0===a?void 0:a.length)<1?(0,x.jsx)(C.A,{message:"Budgets not loaded, Please Refresh or Create New Budget",children:(0,x.jsx)("div",{children:(0,x.jsx)(h.A,{icon:(0,x.jsx)(A.oWz,{}),text:"Refresh Budgets",variant:"primary",onClick:n})})}):(0,x.jsx)(x.Fragment,{children:a.map((e=>(0,x.jsx)("div",{className:"budget-card-wrapper",children:(0,x.jsx)(w,{title:e.name,amount:e.amount,interval:e.interval,startDate:e.start_date,logo:e.logo,spent:e.spent||0,percentage_spent:e.percentage_spent||0,percentage_remaining:e.percentage_remaining||0,onEdit:()=>s(e),onDelete:()=>i(e.id),onClick:()=>{r(e)}})},e.id)))})})};var S=a(3156),M=a(6405),D=a(4770),F=a(90),E=a(2916),V=a(7540),B=a(7077),O=a(9657);const{EXPENSE_CACHE_KEY:z}=(0,o.hz)(),R=()=>{const e=(0,O.Ub)({maxWidth:768}),[t,a]=(0,d.useState)(!0),[m,j]=(0,d.useState)(!1),[p,b]=(0,d.useState)(null),[N,w]=(0,d.useState)("summary"),[A,C]=(0,d.useState)({value:(new Date).getMonth(),label:(0,o.Ly)()[(new Date).getMonth()].label}),[_,R]=(0,d.useState)({value:(new Date).getFullYear(),label:(new Date).getFullYear().toString()}),[I,L]=(0,d.useState)({}),[Y,T]=(0,d.useState)(!1),[W,P]=(0,d.useState)([]),[H,U]=(0,d.useState)([]),[J,K]=(0,d.useState)("name"),[Q,G]=(0,d.useState)(null),[X,q]=(0,d.useState)(null),[Z,$]=(0,d.useState)(0),[ee,te]=(0,d.useState)({}),[ae,ne]=(0,d.useState)(!1),[se,ie]=(0,d.useState)(null),[re,le]=(0,d.useState)(!1),ce=function(){ie(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null),ne(!0)},oe=()=>{ne(!1),ie(null)},de=(0,d.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=await(0,c.ar)(e,t);L(a),T(!0)}),[]),ue=(0,d.useCallback)((async function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];j(!0),w("summary"),await de(e,!0);const t=localStorage.getItem("budgets_amount_map_cache_last_fetched");if(t)b(Number(t));else{const e=Date.now();localStorage.setItem("budgets_amount_map_cache_last_fetched",e),b(e)}j(!1)}),[de]),me=(0,d.useCallback)(((e,t,a,s)=>e.map((e=>{const i=parseFloat(e.amount),r=(e.categories||[]).reduce(((e,n)=>{const i="".concat(t,"_").concat(a,"_").concat(n);return e+(s[i]||0)}),0),l=i>0?+(r/i*100).toFixed(2):0,c=+(100-l).toFixed(2);return(0,n.A)((0,n.A)({},e),{},{spent:+r.toFixed(2),percentage_spent:l,percentage_remaining:c})}))),[]),he=(0,d.useCallback)((async()=>{a(!0);const e=await(0,c.xg)(),t=_.value,n=A.value,s=me(e,t,n,I);if(P(s),Q){const e=s.find((e=>e.id===Q));q(e||null)}a(!1)}),[_,A,I,Q,me]);(0,d.useEffect)((()=>{(async()=>{a(!0);const e=await(0,V.Jt)(z);U((null===e||void 0===e?void 0:e.map((e=>({value:e.id,label:e.name}))))||[]),await de();const t=localStorage.getItem("budgets_amount_map_cache_last_fetched");if(t)b(Number(t));else{const e=Date.now();localStorage.setItem("budgets_amount_map_cache_last_fetched",e),b(e)}})()}),[de]),(0,d.useEffect)((()=>{Y&&he()}),[Y,_,A,I,he]);const ge=(0,d.useMemo)((()=>((e,t)=>{var a;return null===(a=[...e])||void 0===a?void 0:a.sort(((e,a)=>"name"===t?e.name.localeCompare(a.name):"amount"===t?a.amount-e.amount:"spent"===t?a.spent-e.spent:"percentage_spent"===t?a.percentage_spent-e.percentage_spent:"percentage_remaining"===t?a.percentage_remaining-e.percentage_remaining:"created_at"===t?new Date(a.created_at)-new Date(e.created_at):"updated_at"===t?new Date(a.updated_at)-new Date(e.updated_at):0))})(W,J)),[W,J]),xe=(0,d.useCallback)((e=>{w("info"),G(e.id),q(e)}),[]);return(0,d.useEffect)((()=>{var e;if("transactions"!==N||null===X||void 0===X||null===(e=X.categories)||void 0===e||!e.length)return;let t=!0;return(async()=>{a(!0);const e=(await(0,B.r2)()).filter((e=>{const t=new Date(e.date);return"Expense"===e.type&&X.categories.includes(e.category_id)&&t.getMonth()===A.value&&t.getFullYear()===_.value}));t&&(te((0,o.SS)(e)),$(e.reduce(((e,t)=>e+t.amount),0)),a(!1))})(),()=>{t=!1}}),[N,A,_,X]),(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(u.A,{title:"Budgets ".concat(X?"<> "+X.name:""," ").concat("transactions"===N?"<> Transactions":""),onRefresh:ue,onBack:"summary"===N?null:()=>{"info"===N?(w("summary"),q(null)):w("info")},children:[(0,x.jsx)("div",{className:"sync-status",children:(0,x.jsx)("small",{className:"sync-time",children:m?(0,x.jsxs)("span",{style:{display:"flex",gap:5},children:[(0,x.jsx)(y.MdSync,{className:"syncing-icon"}),"Recalculating Budget"]}):(0,x.jsxs)("span",{style:{display:"flex",gap:5},children:[(0,x.jsx)(S.cxC,{}),"Calcualted:\xa0",(0,o.gs)(p)]})})}),!t&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{className:"budgets-header",children:[(0,x.jsx)("div",{className:"left-buttons",children:"summary"===N&&(0,x.jsx)(g.A,{options:l,value:l.find((e=>e.value===J)),onChange:e=>K(e.value),isDisabled:t})}),(0,x.jsx)("div",{className:"right-controls",children:"summary"===N&&(0,x.jsx)(h.A,{icon:(0,x.jsx)(S.ApK,{}),text:e?null:"Add Budget",variant:"primary",onClick:()=>ce()})})]}),(0,x.jsx)(D.A,{yearValue:_,onYearChange:e=>R(e),monthValue:A,onMonthChange:e=>C(e),disabled:t})]}),(0,x.jsxs)(s.N,{mode:"wait",children:["summary"===N&&(0,x.jsx)(k,{loading:t,sortedBudgets:ge,refreshData:ue,handleDialogOpen:ce,handleDelete:async e=>{try{await(0,r.gi)(e),setTimeout((async()=>{await ue(!1)}),1e3)}catch(t){console.error("Error deleting budget:",t)}},onBudgetCardClick:xe}),"info"===N&&X&&(0,x.jsx)(i.P.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:(0,x.jsx)(f,{budget:X,selectedYear:_,selectedMonth:A,onViewTransations:()=>{w("transactions")}})},"info"),"transactions"===N&&(0,x.jsx)(x.Fragment,{children:t?(0,x.jsx)(M.A,{text:"Loading Transactions"}):(0,x.jsx)(i.P.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},children:(0,x.jsx)(E.A,{name:null===X||void 0===X?void 0:X.name,amount:Z,transactions:ee})},"transactions")})]})]}),(0,x.jsxs)(F.A,{showModal:ae,onClose:oe,children:[(0,x.jsx)("div",{style:{marginTop:5,marginBottom:10},children:(0,x.jsx)("h3",{children:se?"Edit Budget":"Add Budget"})}),(0,x.jsx)(i.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},children:(0,x.jsx)(v,{initialData:se,onSave:async e=>{if(!re){le(!0);try{const t=(0,o.rU)();if(!t)return;const a=(0,n.A)((0,n.A)({},e),{},{amount:parseFloat(e.amount),categories:e.categories.map((e=>e.value))});se?await(0,r.cR)((0,n.A)((0,n.A)({},a),{},{id:se.id,user_id:t})):await(0,r.YJ)(a),le(!1),oe(),setTimeout((async()=>{await ue(!1)}),1e3)}catch(t){console.error("Error saving budget:",t)}}},onCancel:oe,saving:re,categoryOptions:H})})]})]})}},5843(e,t,a){var n;a.d(t,{Wx:()=>p});var s=a(9379),i=a(3986),r=a(5043);const l=["as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];var c,o=Object.defineProperty,d=(e,t,a)=>((e,t,a)=>t in e?o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!==typeof t?t+"":t,a),u=new Map,m=new WeakMap,h=0;function g(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return"".concat(t,"_").concat("root"===t?(a=e.root)?(m.has(a)||(h+=1,m.set(a,h.toString())),m.get(a)):"0":e[t]);var a})).toString()}function x(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:c;if("undefined"===typeof window.IntersectionObserver&&void 0!==n){const s=e.getBoundingClientRect();return t(n,{isIntersecting:n,target:e,intersectionRatio:"number"===typeof a.threshold?a.threshold:0,time:0,boundingClientRect:s,intersectionRect:s,rootBounds:s}),()=>{}}const{id:s,observer:i,elements:r}=function(e){const t=g(e);let a=u.get(t);if(!a){const n=new Map;let s;const i=new IntersectionObserver((t=>{t.forEach((t=>{var a;const i=t.isIntersecting&&s.some((e=>t.intersectionRatio>=e));e.trackVisibility&&"undefined"===typeof t.isVisible&&(t.isVisible=i),[...null!=(a=n.get(t.target))?a:[]].forEach((e=>{e(i,t)}))}))}),e);s=i.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),a={id:t,observer:i,elements:n},u.set(t,a)}return a}(a),l=r.get(e)||[];return r.has(e)||r.set(e,l),l.push(t),i.observe(e),function(){l.splice(l.indexOf(t),1),0===l.length&&(r.delete(e),i.unobserve(e)),0===r.size&&(i.disconnect(),u.delete(s))}}var v,j;r.Component;function p(){let{threshold:e,delay:t,trackVisibility:a,rootMargin:n,root:s,triggerOnce:i,skip:l,initialInView:c,fallbackInView:o,onChange:d}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var u;const[m,h]=r.useState(null),g=r.useRef(d),v=r.useRef(c),[j,p]=r.useState({inView:!!c,entry:void 0});g.current=d,r.useEffect((()=>{if(void 0===v.current&&(v.current=c),l||!m)return;let r;return r=x(m,((e,t)=>{const a=v.current;v.current=e,(void 0!==a||e)&&(p({inView:e,entry:t}),g.current&&g.current(e,t),t.isIntersecting&&i&&r&&(r(),r=void 0))}),{root:s,rootMargin:n,threshold:e,trackVisibility:a,delay:t},o),()=>{r&&r()}}),[Array.isArray(e)?e.toString():e,m,s,n,i,l,a,o,t]);const f=null==(u=j.entry)?void 0:u.target,y=r.useRef(void 0);m||!f||i||l||y.current===f||(y.current=f,p({inView:!!c,entry:void 0}),v.current=c);const b=[h,j.inView,j.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}null!=(j=null!=(v="useInsertionEffect"in(n||(n=a.t(r,2)))?r.useInsertionEffect:void 0)?v:r.useLayoutEffect)||r.useEffect}}]);
//# sourceMappingURL=63.4278860b.chunk.js.map